<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horatium</title>
    <link rel="stylesheet" href="./style.css">
    <link rel="manifest" href="./manifest.json">
    <link rel="shortcut icon" href="./img/icons/favicon.ico" type="image/x-icon">
    <!-- Font awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
</head>
<body>
    
    <div id="app" v-cloak>
        <div class="split">

            <div class="type">
                <p>Scegli il tipo di orario: </p>
                <button v-for="scheduleType in scheduleTypes" @click="updateType(scheduleType)"> 
                    {{ scheduleType }}
                </button>
            </div>

            <!-- <div class="year" v-if="selectedType == 'Classi'">
                <p>Scegli l'anno: </p>
                <button v-for="index in 5" @click="updateYear(index)">
                    {{ index }}
                </button>
            </div> -->

            <div class="section" v-if="selectedType == 'Classi'">
                <p>Scegli la sezione: </p>    
                <div class="grid-button">
                    <button v-for="classe in classiMatrice[selectedYear-1]" @click="updateSection(classe)">
                        {{ classe }}
                    </button>
                </div>
            </div>
    
            
            <div class="teacher" v-if="selectedType == 'Docenti'">
                <p>Scegli il docente: </p>
                <div class="docente-grid-button">
                    <button v-for="docente in Docenti" @click="updateSection(docente)">
                        {{ docente }}
                    </button>
                </div>
            </div>

            <div class="teacher" v-if="selectedType == 'Aule'">
                <p>Scegli l'aula: </p>
                <button v-for="aula in aule" @click="updateSection(aula)">
                    {{ aula }}
                </button>
            </div>

            <section class="right">

                <h1>{{selectedClass}}</h1>
                
                <div class="grid">
                    <div class="item" 
                    :class=" 'h' + materie.height , {itemZoom: index == selectedIndex && isSelected} " 
                    :style="{backgroundColor: materie.backgroundColor}"  
                    v-for="(materie , index) in orario[selectedType][selectedClass]" 
                    @click="zoomSubject(index)" 
                    >
                        
                        <div v-if="materie.type == 'subject'" class="subjects" :style="{color: materie.color+'e0'}" >
                            <p>{{ materie.classNumber }}</p>
                            <p v-show="isSelected">{{ materie.teacher }}</p>
                            <p v-show="isSelected">{{ materie.classRoom }}</p>
                            <p v-if="windowWidth>800">{{ materie.subject }}</p>
                        </div>
                        <p v-else-if="windowWidth>800" class="dates">
                            {{ materie.date }}
                        </p>
                    </div>
                </div>
            </section>

            <div class="settings">
                <h1>Impostazioni:</h1>
                <label>Tema: </label>
                <select v-model="selectedTheme">
                    <option>Chiaro</option>
                    <option>Scuro</option>
                </select>

                <label>Font: </label>
                <select>
                    <option>Jetbrains Mono</option>
                    <option>Poppins</option>
                    <option>Inter</option>
                </select>

            </div>
        </div>

        <div class="move">
            <button @click="indietro()">
                <i class="fa-solid fa-angles-left"></i>
                Indietro
            </button>
            <button @click="avanti()">
                Avanti
                <i class="fa-solid fa-angles-right"></i>
            </button>
        </div>

        <div class="home" @click="home()">
            <i class="fa-solid fa-house"></i>
        </div>

    </div>



    <script type="module">
        import { createApp } from 'https://unpkg.com/vue@3/dist/vue.esm-browser.prod.js'
        
        import classi from './data/Classi.json' assert { type: "json" }
        import classiMatrice from './data/classesMatrix.json' assert { type: "json" }
        import Docenti from './data/Docenti.json' assert { type: "json" }
        import aule from './data/Aule.json' assert { type: "json" }
        
        import orario from './data/Schedule.json' assert { type: "json" }
        
        let app = createApp({
            data(){
                return{
                    classi,
                    classiMatrice,
                    aule,
                    Docenti,
                    
                    orario,
                    
                    selectedYear: 0,
                    selectedIndex: -1,
                    scheduleTypes: ['Classi', 'Docenti', 'Aule'],
                    isSelected: false,
                    selectedType: 'Classi',
                    selectedClass: "4CIA",
                    windowWidth: window.innerWidth
                }
            },
            methods: {
                updateYear(year) {
                    this.selectedYear = year
                    console.log(this.selectedYear)
                    this.avanti()
                },
                updateSection(classe){
                    this.selectedClass = classe
                    console.log(this.selectedClass)
                    this.avanti()
                },
                updateType(scheduleType){
                    this.selectedType = scheduleType
                    console.log(this.selectedType)
                    this.avanti()
                },
                zoomSubject(index){
                    this.selectedIndex = index
                    this.isSelected = !this.isSelected
                    console.log(this.selectedIndex)
                    console.log(this.isSelected)
                },
                avanti(){
                    document.querySelector('.split').scrollBy({
                        top: 0,
                        left: window.innerWidth,
                        behavior: 'smooth'
                    })
                    console.log('avanti')
                },
                indietro(){
                    document.querySelector('.split').scrollBy({
                        top: 0,
                        left: -window.innerWidth,
                        behavior: 'smooth'
                    })
                    console.log('indietro')
                },
                home(){
                    document.querySelector('.split').scroll({
                        top: 0,
                        left: 0,
                        behavior: 'smooth'
                    })
                    console.log('indietro')
                },
            },
            mounted() {
                if (localStorage.selectedClass) {
                    this.selectedClass = localStorage.selectedClass;
                    this.selectedYear = localStorage.selectedYear;
                }
            },
            watch: {
                selectedClass(newSelectedClass) {
                    localStorage.selectedClass = newSelectedClass;
                },
                selectedYear(newSelectedYear) {
                    localStorage.selectedYear = newSelectedYear;
                }
            },
            computed: {
                getOrario() {
                    return this[`orario${selectedType}`][selectedClass]
                }
            }
        })

        const mountedApp = app.mount('#app')

    </script>
</body>
</html>
